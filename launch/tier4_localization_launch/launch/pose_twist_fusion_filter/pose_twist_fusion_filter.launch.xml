<?xml version="1.0"?>
<launch>
  <arg name="input_initial_pose_name" default="/initialpose3d"/>
  <arg name="input_pose_with_cov_name" default="/localization/pose_estimator/pose_with_covariance"/>
  <arg name="input_twist_with_cov_name" default="/localization/twist_estimator/twist_with_covariance"/>
  <arg name="output_odom_name" default="kinematic_state"/>
  <arg name="output_pose_name" default="pose"/>
  <arg name="output_pose_with_covariance_name" default="/localization/pose_with_covariance"/>
  <arg name="output_biased_pose_name" default="biased_pose"/>
  <arg name="output_biased_pose_with_covariance_name" default="biased_pose_with_covariance"/>
  <arg name="output_twist_name" default="twist"/>
  <arg name="output_twist_with_covariance_name" default="twist_with_covariance"/>
  <arg name="param_file" default="$(var ekf_localizer_param_path)"/>

  <arg name="use_twist_with_covariance" default="True"/>
  <arg name="input_odom_name" default="/localization/pose_twist_fusion_filter/kinematic_state"/>
  <arg name="input_twist_with_covariance_name" default="/localization/pose_twist_fusion_filter/twist_with_covariance"/>
  <arg name="output_odom_name2" default="/localization/kinematic_state"/>

  <arg name="use_odom" default="true"/>
  <arg name="in_odom" default="/localization/kinematic_state"/>
  <arg name="in_twist" default="/localization/twist_estimator/twist_with_covariance"/>
  <arg name="out_accel" default="/localization/acceleration"/>

  <group>
    <include file="$(find-pkg-share ekf_localizer)/launch/ekf_localizer.launch.xml">
      <arg name="input_initial_pose_name" value="$(var input_initial_pose_name)"/>
      <arg name="input_pose_with_cov_name" value="$(var input_pose_with_cov_name)"/>
      <arg name="input_twist_with_cov_name" value="$(var input_twist_with_cov_name)"/>
      <arg name="output_odom_name" value="$(var output_odom_name)"/>
      <arg name="output_pose_name" value="$(var output_pose_name)"/>
      <arg name="output_pose_with_covariance_name" value="$(var output_pose_with_covariance_name)"/>
      <arg name="output_biased_pose_name" value="$(var output_biased_pose_name)"/>
      <arg name="output_biased_pose_with_covariance_name" value="$(var output_biased_pose_with_covariance_name)"/>
      <arg name="output_twist_name" value="$(var output_twist_name)"/>
      <arg name="output_twist_with_covariance_name" value="$(var output_twist_with_covariance_name)"/>
      <arg name="param_file" value="$(var ekf_localizer_param_path)"/>
    </include>
  </group>

  <group>
    <include file="$(find-pkg-share stop_filter)/launch/stop_filter.launch.xml">
      <arg name="use_twist_with_covariance" value="$(var use_twist_with_covariance)"/>
      <arg name="input_odom_name" value="$(var input_odom_name)"/>
      <arg name="input_twist_with_covariance_name" value="$(var input_twist_with_covariance_name)"/>
      <arg name="output_odom_name2" value="$(var output_odom_name2)"/>
    </include>
  </group>

  <group>
    <include file="$(find-pkg-share twist2accel)/launch/twist2accel.launch.xml">
      <arg name="use_odom" value="$(var use_odom)"/>
      <arg name="in_odom" value="$(var in_odom)"/>
      <arg name="in_twist" value="$(var in_twist)"/>
      <arg name="out_accel" value="$(var out_accel)"/>
    </include>
  </group>
</launch>
